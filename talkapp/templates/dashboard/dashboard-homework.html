{% extends 'base.html' %}{% load static %}
{% block title %}
<title>Задания</title>
{% endblock %}
{% block cssfiles %}
<link href="https://vjs.zencdn.net/7.8.3/video-js.css" rel="stylesheet" />
<link href="https://unpkg.com/@videojs/themes@1/dist/city/index.css" rel="stylesheet"/>
<link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css'>
<link href="https://fonts.googleapis.com/css?family=Poppins:200,300,400,500,600,700,800,900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.0.0/animate.min.css"/>
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css" />
<link href="https://fonts.googleapis.com/css?family=Montserrat&display=swap" rel="stylesheet" />
<link rel="stylesheet" href={% static "css/open-iconic-bootstrap.min.css" %}>
<link rel="stylesheet" href={% static "css/owl.carousel.min.css" %}>
<link rel="stylesheet" href={% static "css/owl.theme.default.min.css" %}>
<link rel="stylesheet" href={% static "css/magnific-popup.css" %}>
<link rel="stylesheet" href={% static "css/style.css" %}>
<link rel="stylesheet" href={% static "css/simple-sidebar.css" %}>
<link rel="stylesheet" href={% static "css/main.css" %}>
<link rel="stylesheet" href={% static "css/dashboard.css" %}>

{% endblock %}
{% block content %}
{% include "dashboard/dashboard-header.html" %}
<div class="d-flex right-toggled" id="wrapper">

    <div id="left-sidebar-wrapper">
        <div class="list-group mx-auto" id="list-tab" role="tablist">
            <a class="list-group-item list-group-item-action " id="dd0" data-toggle="list" href="../dashboard/lk" role="tab"><p style="margin-bottom: 0">Личный кабинет</p></a>
            <a class="list-group-item list-group-item-action" id="dd1" data-toggle="list" href="../dashboard/platform" role="tab"><p style="margin-bottom: 0">Онлайн класс</p></a>
            <a class="list-group-item list-group-item-action active" id="dd5" data-toggle="list" href="../dashboard/homework" role="tab"><p style="margin-bottom: 0">Домашние задания</p></a>
            <a class="list-group-item list-group-item-action" id="dd3" data-toggle="list" href="../dashboard/schedule" role="tab"><p style="margin-bottom: 0">Расписание</p></a>
            <a class="list-group-item list-group-item-action" id="dd8" data-toggle="list" href="../dashboard/tape" role="tab"><p style="margin-bottom: 0">Словарь</p></a>
            <a class="list-group-item list-group-item-action" id="dd9" data-toggle="list" href="../dashboard/account" role="tab"><p style="margin-bottom: 0">Профиль</p></a>
        </div>
    <div class="subscribe-block mx-auto">
        <h1>Будьте в курсе</h1>
        <p>Получайте информацию о сервисе и специальных предложениях</p>
        <button class="dashboard-button-primary">Подписаться</button>
    </div>
    <div class="subscribe-block subscribe-block-2 mx-auto">
        <h1>Есть вопросы?</h1>
        <p>Не нашли ответа на свой вопрос? Задайте его нам</p>
        <a href="https://t.me/eng_talk" target="_blank"><button class="dashboard-button-primary">Связаться</button></a>
    </div>
    </div>

    <!-- Page Content -->
    <div  id="page-content-wrapper" style="overflow-y: hidden">
        <div class="card-group">
            <div class="card" style="border: none; color: #333333">
                <div class="card-header" style="background: transparent; border: none; height: 100%">
                    <div class="blogs-header-text">
                        Задания
                    </div>
                    <div class="blogs-header">
                        <div id="clsbtn" class="blogs-header">

                        </div>
                        <div id="course-name" class="blogs-header-text">

                        </div>
                    </div>

                    <div style="display: flex; margin-bottom: 18px">
                        <div id="submit-answer-button"></div>

                        <div style="margin-left: auto">
                            <div id="submit-answer-teacher-button"> </div>
                        </div>

                    </div>

                    <ul class="nav nav-tabs" id="myTab" role="tablist" style="border-bottom: 0; display: none">
                        <li class="nav-item" role="presentation">
                            <a class="nvlnk" id="tab1" data-bs-toggle="tab" onclick="$('#home1').show(); $('#home2').hide(); $('#home3').hide()" href="#home1" role="tab" aria-controls="home" aria-selected="true" style="padding: 8px 70px">Задано</a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="nvlnk" id="tab2" data-bs-toggle="tab" onclick="$('#home2').show(); $('#home1').hide(); $('#home3').hide()" href="#home2" role="tab" aria-controls="home" aria-selected="true" style="padding: 8px 70px">Проверка</a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="nvlnk" id="tab3" data-bs-toggle="tab" onclick="$('#home3').show(); $('#home1').hide(); $('#home2').hide()" href="#home3" role="tab" aria-controls="home" aria-selected="true" style="padding: 8px 70px">Проверено</a>
                        </li>

                    </ul>


                    <div class="tab-content" id="myTabContent" style="height: 100%">
                        <div class="card-body" >
                                {% if is_teacher %}
                                {% if lsn == 0 %}
                                <div class="empty-lesson">
                                    <div>
                                        <p class="empty-lesson-text">Нет уроков <img src='{% static "images/sad.png" %}'></p>
                                    </div>
                                </div>
                                {% else %}
                                {% for c in courses %}
                                <div class="lesson-crs">
                                        {% if c.get_student_image == -1 %}
                                            <a style="color: #333333" href="#" id="openUserHmwork{{c.id}}" onclick="joinToRoom('{{c.video_chat}}');crsnm('{{c.student.first_name}} {{c.student.last_name}}', '{% static 'images/avatar.png' %}'); courseheader('{{c.course_type}}')"  data-coursename="{{c.course_type}}">
                                        {% else %}
                                            <a style="color: #333333" href="#" id="openUserHmwork{{c.id}}" onclick="joinToRoom('{{c.video_chat}}');crsnm('{{c.student.first_name}} {{c.student.last_name}}', '{{c.get_student_image}}'); courseheader('{{c.course_type}}')"  data-coursename="{{c.course_type}}">
                                        {% endif %}
                                        <div class="lesson-name">
                                            {{c.course_type}}
                                        </div>
                                        <div class="lesson-progress">
                                            {% if c.get_student_image == -1 %}
                                            <img src='{% static "images/avatar.png" %}' style="width: 40px; height: 40px; border-radius: 40px">
                                            {% else %}
                                            <img src="{{c.get_student_image}}" style="width: 40px; height: 40px; border-radius: 40px">
                                            {% endif %}
                                            <div class="progress-num my-auto">
                                                {{c.student.first_name}} {{c.student.last_name}}
                                            </div>
                                        </div>
                                    </a>

                                </div>
                                {% endfor %}
                                {% endif %}
                                {% else %}
                                {% if lsn == 0 %}
                                <div class="empty-lesson">
                                    <div>
                                        <p class="empty-lesson-text">Пока вы не записались на уроки <img src='{% static "images/sad.png" %}'></p>
                                        <a href="#" class="empty-lesson-text-small" data-bs-toggle="modal" data-bs-target="#flModal"> изменить расписание » </a>
                                    </div>
                                </div>
                                {% else %}
                                {% for c in courses %}
                                <div class="lesson-crs">
                                {% if c.get_teacher_image == -1 %}
                                    <a style="color: #333333" href="#" id="openUserHmwork{{c.id}}" onclick="joinToRoom('{{c.video_chat}}');crsnm('{{c.teacher.user.first_name}} {{c.teacher.user.last_name}}','{% static 'images/avatar.png' %}'); courseheader('{{c.course_type}}')" data-coursename="{{c.course_type}}">
                                        {% else %}
                                    <a style="color: #333333" href="#" id="openUserHmwork{{c.id}}" onclick="joinToRoom('{{c.video_chat}}');crsnm('{{c.teacher.user.first_name}} {{c.teacher.user.last_name}}','{{c.get_teacher_image}}'); courseheader('{{c.course_type}}')" data-coursename="{{c.course_type}}">
                                        {% endif %}
                                        <div class="lesson-name">
                                            {{c.course_type}}
                                        </div>
                                        <div class="lesson-progress">
                                            {% if c.get_teacher_image == -1 %}
                                            <img src='{% static "images/avatar.png" %}' style="width: 40px; height: 40px; border-radius: 40px">
                                            {% else %}
                                            <img src="{{c.get_teacher_image}}" style="width: 40px; height: 40px; border-radius: 40px">
                                            {% endif %}
                                            <div class="progress-num my-auto">
                                                {{c.teacher.user.first_name}} {{c.teacher.user.last_name}}
                                            </div>
                                        </div>
                                    </a>

                                </div>
                                {% endfor %}
                                {% endif %}
                                {% endif %}


                            </div>


                    </div>
                    <div class="tab-pane fade " id="home1" role="tabpanel" aria-labelledby="home-tab">

                        </div>
                        <div class="tab-pane fade " id="home2" role="tabpanel" aria-labelledby="home-tab">

                        </div>
                        <div class="tab-pane fade " id="home3" role="tabpanel" aria-labelledby="home-tab">

                        </div>




                </div>
                <div style="position: absolute; bottom: -1%;margin-left: auto;margin-right: auto;left: 0;right: 0;text-align: center;">
                    <button data-bs-toggle="modal" type="button" data-bs-target="#tapeModal" class="tape-btn" style="margin-right: 32px">+ Добавить слово</button>
                    Режим учебника
                    <label class="switch">
                        <input type="checkbox">
                        <span class="slider round" id="zmbtn" onclick="zoom()"></span>
                    </label>
                </div>

            </div>


            <div class="card" style="max-width: 380px; max-height: 707px; border: 1px rgb(189,189,189,0.25) solid; border-radius: 5px; min-height: 84vh; margin-top: 5px" id="chat">
                <div class="card-header" id="chat-header" style="display: flex; background-color: #2f80ed1a;">

                    {% if image == -1 %}
                    <img id="teacher-img" src='{% static "images/avatar.png" %}' style="width: auto; height: auto; max-width: 72px;max-height: 72px;  border-radius: 100%; margin-right: 14px;"  align="center">
                    <br>
                    {% else %}
                    <img id="teacher-img" src='{{image.url}}' style="width: auto; height: auto; max-width: 72px;max-height: 72px;  border-radius: 100%; margin-right: 14px;"  align="center">
                    <br>
                    {% endif %}
                            <img id="teacher-img-2" src='{% static "images/avatar.png" %}' style="width: auto; height: auto; max-width: 72px;max-height: 72px;  border-radius: 100%; margin-right: 14px;display: none"  align="center">

                    <div class="teacher-name-p"></div>
                    <button style="margin-right: 1em;position: absolute; top: 3.5%; right: 10px; background: transparent; color: #2F80ED; border: 0; display: none" id="join" type="submit" form="join-form" class="btn btn-success btn-sm"><i class="fas fa-video" style="font-size: 30px"></i></button>
                </div>
                <div class="card-body" style="background-color: #007bff29;">
                            <div id="chat-list">
                                </div>
                            <div id="chat-window" style="display: none">
                            <div class="row video-group draggable ui-widget-content mx-auto" id="draggable_video" style="display: none; visibility: visible; max-width: 300px; max-height: 170px">
                                    <div class="col" style="padding-left: 0; padding-right: 0">
                                        <div id="remote-playerlist" style="height: 170px"></div>
                                        <div id="local-player" style="position: absolute;width: 80px;height: 100px;right: 0;top: 0;"></div>
                                    </div>
                            </div>
                            <div>
                                <form id="join-form" style="display: none">
                                    <div class="button-group" style="text-align: center">
                                        <button style="margin-right: 1em;" id="leave" type="button" class="btn btn-danger btn-sm" disabled><i class="fas fa-phone-slash"></i></button>
                                        <button style="margin-right: 1em;" id="mute-audio" type="button" class="btn btn-success btn-sm"><i class="fas fa-microphone"></i></button>
                                        <button style="margin-right: 1em;" id="mute-video" type="button" class="btn btn-success btn-sm"><i class="fas fa-video"></i></button>
                                        <button style="margin-right: 1em;" id="drag-video" type="button" class="btn btn-warning btn-sm"><i style="color: white" class="fas fa-arrows-alt"></i></button>
                                    </div>
                                </form>

                                <div class="mt-3" id="chat-log-p" style="border-radius: 5px;max-height: 85%; overflow: hidden; position: absolute; bottom: 0; left: 0; width: 100%">
                                    <ul id="chat-log" style="overflow: auto;max-height: 69vh; margin-bottom: 2px">
                                    </ul>
                                </div>
                                <div class="row g-0" style="background: white;position: absolute;bottom: -6%;left:4%;width: 100%; border: 1px solid rgba(0,0,0,0.125);border-radius: 0px; margin-bottom: 10px;">
                                    <div style="max-width: 100%;padding:0;flex: 0 0 90%;" class="col-sm-6 col-md-8"><input id="chat-message-input" style="padding: 16px 0px 16px 45px; border: 0; font-family: Arial; font-style: normal; font-weight: normal; font-size: 16px; line-height: 18px; color: #BDBDBD;" autocomplete="off" type="text" class="form-control inpt" placeholder="Нажмите, чтобы написать сообщение"/></div>
                                    <div class="col-6 col-md-4  my-auto" style="max-width: 7%;background: white; padding-left: 0">
                                        <button id="chat-message-submit" class="btn btn-secondary mx-auto my-auto" style="padding:0; border-radius: 50px; font-size: x-large; border: 0;background: #2f80ed;width: 30px; height: 30px" type="submit">
                                            <i class="fas fa-chevron-right" style="position: absolute; top:3px; left: 9px"></i>
                                        </button>
                                    </div>
                                    <div  class="col-6 col-md-4  my-auto" style="max-width: 9%;background: white; margin-left: -95%; padding-left: 0">
                                        <button onclick="$('#js-file').click()" class="btn btn-secondary mx-auto my-auto" style="padding:0; border-radius: 50px; font-size: x-large; border: 0;background: #28a745ba;width: 30px; height: 30px">
                                            <i class="fas fa-plus" style="position: absolute; top:3px; left: 5px"></i>
                                        </button>
                                        <input style="display:none" type="file" id="js-file">
                                    </div>

                                </div>
                            </div>
                            </div>
                        </div>
                    </div>
        </div>
    </div>
</div>
<!--
<div class="modal fade" id="dzModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
<div class="modal-dialog">
<div class="modal-content">
  <div class="modal-header">
    <h5 class="modal-title" id="exampleModalLabel">Здесь тема урока</h5>
    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
          <a id="student_email" href="" target="_blank" rel="noopener noreferrer">Отправить домашнее задание</a>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
  </div>
</div>
</div>
</div>
-->

<div class="modal fade" id="tapeModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content modal-sm mx-auto">
            <div class="modal-header">
                <h5 class="modal-title" style="font-family: Arial;font-style: normal;font-weight: bold;font-size: 24px;line-height: 28px;color: #333333;" id="exampleModalLabel">Добавить слово</h5>
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="padding-right: 30px;padding-left: 30px;">
                <form method="POST" action="/add_word_tape">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="word-name"  style="font-family: Arial;font-style: normal;font-weight: normal;font-size: 12px;line-height: 14px;color: #333333;" class="col-form-label">Слово</label>
                        <input type="text" class="form-word-translate" id="word-name" name="word-name">
                    </div>
                    <div class="form-group">
                        <label for="word-translate-name" style="font-family: Arial;font-style: normal;font-weight: normal;font-size: 12px;line-height: 14px;color: #333333;" class="col-form-label">Перевод</label>
                        <input type="text" class="form-word-translate" id="word-translate-name" name="word-translate-name">
                    </div>
                    <div class="form-group">
                        <input type="submit" value="Добавить в словарь" class="submit-btn-tape" >
                    </div>
                </form>
            </div>

        </div>
    </div>
</div>

<div class="modal fade" id="homeModal" tabindex="-1" aria-labelledby="homeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content modal-sm mx-auto" style="max-width:360px">
            <div class="modal-header">
                <h5 class="modal-title" style="font-family: Arial;font-style: normal;font-weight: bold;font-size: 24px;line-height: 28px;color: #333333;" id="homeModalLabel">Добавить файл</h5>
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="padding-right: 30px;padding-left: 30px;">
                <label style="font-family: Arial;font-style: normal;font-weight: normal;font-size: 12px;line-height: 14px;color: #333333;" class="col-form-label">Тип файла</label>
                <div style="text-align: center">
                    <button type="button" class="tape-btn mx-auto" onclick="upload_file()" style="width: 100%">+ Добавить файл</button>
                    <p class="mx-auto" style="margin: 8px 0px">Или</p>
                </div>
                <form method="post" action="/homework-upload"  id="dzForm" class="dropzone" style="margin-bottom: 24px">
                    {% csrf_token %}
                    <input type="hidden" name="homework-id" id="homework-id">
                  <div class="fallback" >
                    <input name="file" type="file" id="file-input" multiple />
                  </div>
                </form>
                <input type="submit" form="dzForm" class="dashboard-button-secondary-teacher" style="width: 100%" value="Добавить файл">
            </div>

        </div>
    </div>
</div>


<div class="modal fade" id="homeModalCheckAns" tabindex="-1" aria-labelledby="homeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content modal-sm mx-auto" style="max-width:360px">
            <div class="modal-header">
                <h5 class="modal-title" style="font-family: Arial;font-style: normal;font-weight: bold;font-size: 24px;line-height: 28px;color: #333333;" id="createHomeModalLabelCheck">Добавить файл</h5>
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="padding-right: 30px;padding-left: 30px;">
                <label style="font-family: Arial;font-style: normal;font-weight: normal;font-size: 12px;line-height: 14px;color: #333333;" class="col-form-label">Тип файла</label>
                <div style="text-align: center">
                    <button type="button" class="tape-btn mx-auto" onclick="upload_file_ans()" style="width: 100%">+ Добавить файл</button>
                    <p class="mx-auto" style="margin: 8px 0px">Или</p>
                </div>
                <form method="post" action="/homework-upload-teach-answer"  id="dzFormCheck" class="dropzone" style="margin-bottom: 24px">
                    {% csrf_token %}
                    <input type="hidden" name="ans-teach-homework-id" id="ans-teach-homework-id">
                    <div class="fallback" >
                        <input name="file" type="file" id="ans-teac-file-input" multiple />
                    </div>
                </form>
                <input type="submit" form="dzFormCheck" class="dashboard-button-secondary-teacher" style="width: 100%" value="Добавить файл">
            </div>

        </div>
    </div>
</div>



<div class="modal fade" id="createHomeModal" tabindex="-1" aria-labelledby="createHomeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content modal-sm mx-auto" style="max-width:360px">
            <div class="modal-header">
                <h5 class="modal-title" style="font-family: Arial;font-style: normal;font-weight: bold;font-size: 24px;line-height: 28px;color: #333333;" id="createHomeModalLabel">Добавить файл</h5>
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="padding-right: 30px;padding-left: 30px;">
                <form method="post" action="/homework-create" class="dropzone" id="dzCreateForm" style="margin-bottom: 24px">
                    {% csrf_token %}
                    <input type="hidden" name="student-id" id="student-id-input">
                    <input type="text" class="account-input" style="margin-bottom: 10px" name="hw-name" placeholder="Название">
                  <div class="fallback">
                      Документ
                    <input name="file" type="file" id="doc-file-input" multiple />
                  </div>
<!--                    <div class="fallback">-->
<!--                      Видео-->
<!--                    <input name="file" type="file" id="video-file-input" multiple />-->
<!--                  </div>-->
<!--                    <div class="fallback">-->
<!--                        Аудио-->
<!--                    <input name="file" type="file" id="audio-file-input" multiple />-->
<!--                  </div>-->
                </form>
                <input type="submit" id="dzCreateFormSubmit" form="dzCreateForm" class="dashboard-button-secondary-teacher" style="width: 100%" value="Создать домашнее задание">
            </div>

        </div>
    </div>
</div>

{% endblock %}
{% block jsfiles %}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js" integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bs-custom-file-input/dist/bs-custom-file-input.min.js"></script>
<script src={% static "js/jquery.min.js" %}></script>
<script src={% static "js/jquery-migrate-3.0.1.min.js" %}></script>
<script src={% static "js/jquery.waypoints.min.js" %}></script>
<script src={% static "js/jquery.stellar.min.js" %}></script>
<script src={% static "js/owl.carousel.min.js" %}></script>
<script src={% static "js/jquery.magnific-popup.min.js" %}></script>
<script src={% static "js/reconnecting-websocket.min.js" %}></script>
<script src={% static "js/scrollax.min.js" %}></script>
<script src={% static "js/main.js" %}></script>
<script src={% static "js/shedule.js" %}></script>
<script src="https://code.jquery.com/ui/1.11.3/jquery-ui.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.9.2/min/dropzone.min.js" integrity="sha512-VQQXLthlZQO00P+uEu4mJ4G4OAgqTtKG1hri56kQY1DtdLeIqhKUp9W/lllDDu3uN3SnUNawpW7lBda8+dSi7w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
            var user_id = {{request.user.id}}
            var email = '{{email}}';
            {% if is_teacher %}
            var is_teacher = true;
            {% else %}
            var is_teacher = false;
            {% endif %}
            var room_name = '{{video_chat}}';
            function category(id){
                {% for c in video_categories %}
                if (id == {{c.id}}){
                    $('.category-{{c.id}}').show()
                }
                else{
                   $('.category-{{c.id}}').hide()
                }
                {% endfor %}
            }
            function category_showAll(){
                {% for c in video_categories %}
                $('.category-{{c.id}}').show()
                {% endfor %}
            }

            $(document).ready(function () {
            var div = document.getElementById('right-sidebar-wrapper');
            var listener = function(e) {
                if (e.pageX > 300 && e.pageX < 1350 && e.pageY > 325 && e.pageY < 840){
                    div.style.left = e.pageX - 20 + "px";
                    div.style.top = e.pageY - 270 + "px";
                }

            };

            div.addEventListener('mousedown', e => {
                document.addEventListener('mousemove', listener);
            });

            document.addEventListener('mouseup', e => {
                document.removeEventListener('mousemove', listener);
            });
        var a = 0;
          $("#collapse_post").click(function(event) {
            a += 1;
            if (a % 2 == 0){
                $('#collapseExample2').collapse('hide');
                return false;
            }
            else{
                $('#collapseExample2').collapse('show');
            }
          });
        })
        $('#join').on('click', function(e){
            $('#join-form').show();
            $('#chat-header').hide();
            $('.video-group').show();
            $('#chat-log').css('max-height','485px');
        });

        $('#leave').on('click', function(e){
            $('#join-form').hide();
            $('.video-group').hide();
            $('#chat-header').show();
            $('#chat-log').css('max-height','614px');
        });

    $("document").ready(function(){
        $("#chat-log").animate({ scrollTop: 100000 }, 50);
    })





function delHmk(id) {
 if (confirm("Вы подтверждаете удаление?")) {
        $.ajax({
            url: "/ajax_delete_homework/"+id,
            type: 'POST',
            headers:{
            "X-CSRFToken": '{{ csrf_token }}'
             },
            success: function (result) {
                $('#'+'openHmk'+id).parent().remove();
            }

            })
        }
    }


function openHmk(id) {
        $.ajax({
            url: "/ajax_load_homework/"+id,
            success: function (result) {
                $(".lesson").hide();
                var json = $.parseJSON(result);
                json.forEach(function(item, i, json) {
                    if(!$("#docLabel"+id).length){
                        $("#home-tab").removeClass('nvlnk-act');
                        $("#myTabContent").removeClass('show active');
                        {% if not is_teacher %}
                        $("#submit-answer-button").html('<button data-bs-toggle="modal" type="button" data-bs-target="#homeModal" data-homework="'+id+'" class="tape-btn">Отправить решение</button>');
                        {% else %}
                        $("#submit-answer-teacher-button").html('<button data-bs-toggle="modal" type="button" data-bs-target="#homeModalCheckAns" data-homework-ans-teach="'+id+'" class="tape-btn">Отправить решение ученику</button>');
                        {% endif %}
                        $("#home"+json[i].homework_status).append('<div class="tab-pane fade show active" id="doc'+id+'" role="tabpanel" aria-labelledby="docTab'+id+'">'+
                                       ' <div style="font-size: 18px;line-height: 21px; margin-bottom: 14px" class="blogs-header-text">'+
                                           ' <div style="font-size: 24px;line-height: 21px; margin-bottom: 14px; margin-top: 10px" class="blogs-header-text">Материалы:</div>'+
                                           ' '+json[i].homework_name+' '+
                                       ' </div>'+
                                        '<div id="collapseVideo'+id+'"></div>'+
                                        '<div id="collapseAudio'+id+'" style="margin-bottom: 18px"></div>'+
                                        '<div class="collapse show" id="docCard'+id+'"></div>'+
                                 '</div>');
                                 if(json[i].homework_status == 2){
                                     $("#doc"+id).append(
                                        ' <div style="font-size: 24px;line-height: 21px; margin-bottom: 14px; margin-top: 10px" class="blogs-header-text">Ответ ученика:</div>'+
                                        '<div class="collapse show" id="docCardAnsP'+id+'"></div>'

                                     );
                                 }

                                 if(json[i].homework_status == 3){
                                     $("#doc"+id).append(
                                        ' <div style="font-size: 24px;line-height: 21px; margin-bottom: 14px; margin-top: 10px" class="blogs-header-text">Ответ ученика:</div>'+
                                        '<div class="collapse show" id="docCardAnsP'+id+'"></div>'+
                                        ' <div style="font-size: 24px;line-height: 21px; margin-bottom: 14px; margin-top: 10px" class="blogs-header-text">Ответ учителя:</div>'+
                                        '<div class="collapse show" id="docCardAnsT'+id+'"></div>'

                                     );
                                 }
                        $(".breadcrumb-item").removeClass('active');
                        $("#breadcrumb").append('<li class="breadcrumb-item active" ><a style="color: #333333" href="../../dashboard/homework" >Задания</a></li>');
                        $("#breadcrumb").append('<li class="breadcrumb-item active" id="bread-item'+id+'">'+json[i].homework_name+'</li>');

                        $.ajax({
                            url: "/ajax_load_homework_audios/"+id,
                            success: function (result) {
                                var json = $.parseJSON(result);
                                json.forEach(function(item, i, json) {
                                    $("#collapseAudio"+id).append(
                                    '<p style="padding-top: 20px; margin-bottom: 14px">'+json[i].audio_name+'</p>'+
                                    '<div id="audioPlayer'+json[i].audio_id+'"></div>'
                                    );
                                    var audioPlayer = new Playerjs({id:"audioPlayer"+json[i].audio_id, file:json[i].audio_url, player: 2});
                                });
                        }}).then(
                        $.ajax({
                            url: "/ajax_load_homework_videos/"+id,
                            success: function (result) {
                                var json = $.parseJSON(result);
                                json.forEach(function(item, i, json) {
                                    $("#collapseVideo"+id).append(
                                        '<div class="tab-pane fade show active vidosik" id="vid'+id+'" role="tabpanel" aria-labelledby="vidTab'+id+'">'+
                                 '<div class="card-body" style="padding-top: 0">'+
                                 '<div class="mx-auto" id="bgPlayer'+json[i].video_id+'" style="width: 90%; height: 440px;"></div>'+
                                 '</div>'+
                                 '</div>'
                                    );
                                    var player = new Playerjs({id:"bgPlayer"+json[i].video_id, file:json[i].video_url, player: 1});
                                });

                        }})).then(
                        $.ajax({
                            url: "/ajax_load_homework_files/"+id,
                            success: function (result) {
                                var json = $.parseJSON(result);
                                json.forEach(function(item, i, json) {
                                    $("#docCard"+id).append(
                                        '<a href="'+json[i].file_url+'" download><div style="display: flex; margin-bottom: 20px"><img src={% static "images/file-image.jpg" %} width="46px" height="58px"><p class="my-auto" style="margin-left: 16px">'+json[i].file_name+'</p></div></a>'
                                    );
                                });

                        }})).then(
                        $.ajax({
                            url: "/ajax_load_homework_files_pup_ans/"+id,
                            success: function (result) {
                                var json = $.parseJSON(result);
                                json.forEach(function(item, i, json) {
                                    $("#docCardAnsP"+id).append(
                                        '<a href="'+json[i].filePUP_url+'" download><div style="display: flex; margin-bottom: 20px"><img src={% static "images/file-image.jpg" %} width="46px" height="58px"><p class="my-auto" style="margin-left: 16px">'+json[i].filePUP_name+'</p></div></a>'
                                    );
                                });

                        }})).then(
                        $.ajax({
                            url: "/ajax_load_homework_files_teach_ans/"+id,
                            success: function (result) {
                                var json = $.parseJSON(result);
                                json.forEach(function(item, i, json) {
                                    $("#docCardAnsT"+id).append(
                                        '<a href="'+json[i].fileTCH_url+'" download><div style="display: flex; margin-bottom: 20px"><img src={% static "images/file-image.jpg" %} width="46px" height="58px"><p class="my-auto" style="margin-left: 16px">'+json[i].fileTCH_name+'</p></div></a>'
                                    );
                                });

                        }}))
                    }

                    else {
                        $("#home-tab").removeClass('nvlnk-act');
                        $("#home").removeClass('show active');
                        $("#docTab"+id).addClass('nvlnk-act');
                        $("#doc"+id).addClass('show active');
                    }
                });
        }});

    $("#myTabContent").on('click','div[id^="openVid"]', function () {
        $("#menu-toggle-right").hide();
        i = $(this).attr("id");
        lid = $(this).data("lesid");
       const id = i.slice(7);
        $.ajax({
            url: "/ajax_load_video/"+id,
            success: function (result) {
                var json = $.parseJSON(result);
                json.forEach(function(item, i, json) {
                    if(!$("#vidLabel"+id).length){
                        $("#buttonCollapseVideo"+lid).removeClass('nvlnk-act');
                        $("#doc"+lid).removeClass('show active');
                        $("#myTab").append('<li class="nav-item" id="vidLabel'+id+'" role="presentation">'+
                                 '<a class="nvlnk nvlnk-act vidosikTab" id="vidTab'+id+'" onclick="videoOpen('+id+','+lid+')" data-toggle="tab" href="#vid'+id+'" role="tab" aria-controls="vid'+id+'" aria-selected="false">'+json[i].video_name+
                                 '<button type="button" class="close vidClose" onclick="event.stopPropagation();closeVid('+id+','+lid+');" style="padding-left: 5px;" aria-label="Close">'+
                                 '<span aria-hidden="true">&times;</span>'+
                                 '</button>'+
                                 '</a>'+
                                 '</li>');
                        $("#myTabContent").append('<div class="tab-pane fade show active vidosik" id="vid'+id+'" role="tabpanel" aria-labelledby="vidTab'+id+'">'+
                                 '<div class="card-body" style="height: 480px; padding-top: 0">'+
                                 '<div class="mx-auto" id="bgPlayer'+json[i].video_id+'" style="width: 90%; height: 440px;"></div>'+
                                 '</div>'+
                                 '</div>');
                        var player = new Playerjs({id:"bgPlayer"+json[i].video_id, file:json[i].video_url, player: 1});
                    }

                    else {
                        $("#docTab"+lid).removeClass('nvlnk-act');
                        $("#doc"+lid).removeClass('show active');
                        $("#vidTab"+id).addClass('nvlnk-act');
                        $("#vid"+id).addClass('show active');
                    }
                $(".breadcrumb-item").removeClass('active');
                $("#breadcrumb").append('<li class="breadcrumb-item active" id="bread-vid'+id+'">'+json[i].video_name+'</li>');
                });
        }});

    });
};


Dropzone.options.dzForm = {
  dictDefaultMessage: "Перетащите файл в эту область"
};


myDropzone = new Dropzone("form#dzFormCheck", {
      dictDefaultMessage: "Перетащите файл в эту область",
      parallelUploads: 3
});


myDropzone = new Dropzone("form#dzCreateForm", {
      dictDefaultMessage: "Перетащите файл в эту область",
      parallelUploads: 3
});



function upload_file(){
    $("#dzForm .dz-button").click();
}

function upload_file_ans(){
    $("#dzFormCheck .dz-button").click();
}

$('#homeModal').on('show.bs.modal', function (event) {
    var div = $(event.relatedTarget);
    var id = div.data('homework');
    $('#homework-id').val(id);
})

$('#homeModalCheckAns').on('show.bs.modal', function (event) {
    var div = $(event.relatedTarget);
    var id = div.data('homework-ans-teach');
    $('#ans-teach-homework-id').val(id);
})
            $(document).ready(function () {
            var div = document.getElementById('right-sidebar-wrapper');
            var listener = function(e) {
                if (e.pageX > 300 && e.pageX < 1350 && e.pageY > 325 && e.pageY < 840){
                    div.style.left = e.pageX - 20 + "px";
                    div.style.top = e.pageY - 270 + "px";
                }

            };

            div.addEventListener('mousedown', e => {
                document.addEventListener('mousemove', listener);
            });

            document.addEventListener('mouseup', e => {
                document.removeEventListener('mousemove', listener);
            });
        var a = 0;
          $("#collapse_post").click(function(event) {
            a += 1;
            if (a % 2 == 0){
                $('#collapseExample2').collapse('hide');
                return false;
            }
            else{
                $('#collapseExample2').collapse('show');
            }
          });
        })
        $('#join').on('click', function(e){
            $('#join-form').show();
            $('#chat-header').hide();
            $('.video-group').show();
            $('#chat-log-p').css('height','50%');
            $('#hidecam').css('display','contents');
        });

        $('#leave').on('click', function(e){
            $('#join-form').hide();
            $('.video-group').hide();
            $('#chat-header').show();
            $('#chat-log-p').css('height','85%');
            $('#hidecam').css('display','none');
        });

    $("document").ready(function(){
        $("#chat-log").animate({ scrollTop: 100000 }, 50);
    })

var cnt = 0;
function openChat(){
    if (cnt % 2 == 0){
        $('#chat').css('max-width','0');
        $('#chat').css('visibility','hidden');
        $("#draggable_video").css('width','472px');
        $("#draggable_video").css('left','-460px');
    }
    else{
        $('#chat').css('max-width','486px');
        $('#chat').css('visibility','visible');
        $("#draggable_video").css('left','0');
    }
    cnt = cnt + 1
}



function hidcm() {
    $("#draggable_video").toggle();
};

$('#draggable_video').draggable({
    containment: "#wrapper"
});

$( "#draggable_video" ).on( "drag", function( event, ui ) {
    $( "#draggable_video" ).css("transition-duration", 0+"s");
} );

var c = 0;

$( "#drag-video" ).on('click', function(e){
    $( "#draggable_video" ).css("transition-duration", 1.5+"s");
    $( "#draggable_video" ).css("left", 0);
    $( "#draggable_video" ).css("top", 0);



});
        </script>
<script src="{% static 'js/playerjs.js' %}"></script>
<script src={% static "js/dashboard.js" %}></script>
<script>
        </script>
<script src="{% static 'js/chat.js' %}"></script>
<script src="https://download.agora.io/sdk/release/AgoraRTC_N-4.4.0.js"></script>
<script src={% static "js/web.js" %}></script>

{% endblock %}